"use strict";(self.webpackChunktech_blog=self.webpackChunktech_blog||[]).push([[4],{6612:function(e){e.exports=JSON.parse('{"blogPosts":[{"id":"wecom-openapi","metadata":{"permalink":"/zh/wecom-openapi","editUrl":"https://github.com/juzibot/tech-blog/blog/2022-02-18-wecom-openapi.mdx","source":"@site/i18n/zh/docusaurus-plugin-content-blog/2022-02-18-wecom-openapi.mdx","title":"\u4f01\u4e1a\u5fae\u4fe1 x Swagger","description":"\u5728\u6211\u4eec\u5bf9\u63a5\u4f01\u4e1a\u5fae\u4fe1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u4f01\u4e1a\u5fae\u4fe1\u7684 API \u975e\u5e38\u591a\uff0c\u4e14\u53c2\u6570\u5404\u5f02\u3002\u4e3a\u4e86\u6700\u5927\u7a0b\u5ea6\u7684\u51cf\u5c11\u91cd\u590d\u5de5\u4f5c\uff0c\u51cf\u5c11\u7f16\u7801\u4e2d\u7684\u4f4e\u7ea7\u9519\u8bef\uff0c\u6211\u4eec\u51b3\u5b9a\u501f\u52a9\u5de5\u5177\u6765\u81ea\u52a8\u751f\u6210\u4f01\u4e1a\u5fae\u4fe1\u7684 API \u8c03\u7528\u4ee3\u7801\u3002","date":"2022-02-18T00:00:00.000Z","formattedDate":"2022\u5e742\u670818\u65e5","tags":[{"label":"swagger","permalink":"/zh/tags/swagger"},{"label":"openapi","permalink":"/zh/tags/openapi"},{"label":"wecom","permalink":"/zh/tags/wecom"},{"label":"codegen","permalink":"/zh/tags/codegen"}],"readingTime":4.14,"truncated":true,"authors":[{"name":"\u5218\u8d35\u7acb","title":"\u53e5\u5b50\u4e92\u52a8\u8d44\u6df1\u5de5\u7a0b\u5e08","url":"https://github.com/gongzili456","imageURL":"https://avatars.githubusercontent.com/u/6082335","key":"rory"}],"frontMatter":{"slug":"wecom-openapi","title":"\u4f01\u4e1a\u5fae\u4fe1 x Swagger","authors":"rory","tags":["swagger","openapi","wecom","codegen"],"keywords":["swagger","openapi","wecom","wxwork","workweixin","workwx","qychat","qywork","openapi3","codegen","wework","wecaht"]},"nextItem":{"title":"\u53e5\u5b50\u4e92\u52a8\u6280\u672f\u535a\u5ba2\u6b63\u5f0f\u4e0a\u7ebf\uff01","permalink":"/zh/first-blog"}},"content":"import Image from \'@theme/IdealImage\';\\nimport swaggerBanner from \'/img/2022-02-18-wecom-gateway/swagger_banner.jpeg\';\\nimport authorizeStep from \'/img/2022-02-18-wecom-gateway/authorize_step.png\';\\nimport proxyStep from \'/img/2022-02-18-wecom-gateway/proxy_step.png\';\\n\\n\u5728\u6211\u4eec\u5bf9\u63a5\u4f01\u4e1a\u5fae\u4fe1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u4f01\u4e1a\u5fae\u4fe1\u7684 API \u975e\u5e38\u591a\uff0c\u4e14\u53c2\u6570\u5404\u5f02\u3002\u4e3a\u4e86\u6700\u5927\u7a0b\u5ea6\u7684\u51cf\u5c11\u91cd\u590d\u5de5\u4f5c\uff0c\u51cf\u5c11\u7f16\u7801\u4e2d\u7684\u4f4e\u7ea7\u9519\u8bef\uff0c\u6211\u4eec\u51b3\u5b9a\u501f\u52a9\u5de5\u5177\u6765\u81ea\u52a8\u751f\u6210\u4f01\u4e1a\u5fae\u4fe1\u7684 API \u8c03\u7528\u4ee3\u7801\u3002\\n\\n\u8fd9\u4e2a\u65f6\u5019\u5c31\u770b\u5230\u4e86 `Swagger` \u8fd9\u4e2a\u9879\u76ee\uff0c\u4e00\u756a\u5c1d\u8bd5\u4e4b\u540e\uff0c\u7adf\u7136\u5f97\u5230\u4e86\u5982\u6b64\u65b9\u4fbf\u597d\u7528\u7684\u4e00\u5957\u5de5\u5177\u2026\u2026\\n\\n\x3c!--truncate--\x3e\\n\\nGithub: [github.com/juzibot/wecom-openapi](https://github.com/juzibot/wecom-openapi)\\n\\nDemo: [wecom-openapi.juzibot.com](https://wecom-openapi.juzibot.com)\\n\\n## OpenAPI \u89c4\u8303\\n\\nOpenAPI \u89c4\u8303\uff08OAS\uff09\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6807\u51c6\u7684\u3001\u8bed\u8a00\u65e0\u5173\u7684 RESTful API \u63a5\u53e3\u89c4\u8303\uff0c\u5b83\u53ef\u4ee5\u540c\u65f6\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u548c\u8ba1\u7b97\u673a\u67e5\u770b\u5e76\u7406\u89e3\u67d0\u4e2a\u670d\u52a1\u7684\u529f\u80fd\uff0c\u800c\u65e0\u9700\u8bbf\u95ee\u6e90\u4ee3\u7801\u3001\u6587\u6863\u6216\u7f51\u7edc\u6d41\u91cf\u68c0\u67e5\uff0c\u65e2\u65b9\u4fbf\u4eba\u7c7b\u5b66\u4e60\u548c\u9605\u8bfb\uff0c\u4e5f\u65b9\u4fbf\u673a\u5668\u9605\u8bfb\u3002\u6b63\u786e\u5b9a\u4e49 OAS \u540e\uff0c\u5f00\u53d1\u8005\u53ef\u4ee5\u4f7f\u7528\u6700\u5c11\u7684\u5b9e\u73b0\u903b\u8f91\u6765\u7406\u89e3\u8fdc\u7a0b\u670d\u52a1\u5e76\u4e0e\u4e4b\u4ea4\u4e92\u3002\\n\\n\u6b64\u5916\uff0c\u6587\u6863\u751f\u6210\u5de5\u5177\u53ef\u4ee5\u4f7f\u7528 OpenAPI \u89c4\u8303\u6765\u751f\u6210 API \u6587\u6863\uff0c\u4ee3\u7801\u751f\u6210\u5de5\u5177\u53ef\u4ee5\u751f\u6210\u5404\u79cd\u7f16\u7a0b\u8bed\u8a00\u4e0b\u7684\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4ee3\u7801\uff0c\u6d4b\u8bd5\u4ee3\u7801\u548c\u5176\u4ed6\u7528\u4f8b\u3002\u8be6\u89c1\uff1a[OpenAPI Specification](https://swagger.io/specification/)\\n\\n<Image img={swaggerBanner} />\\n\\n## WeCom-OpenAPI\\n\\n\u4f01\u4e1a\u5fae\u4fe1\u5e76\u6ca1\u6709\u63d0\u4f9b\u7b26\u5408 OpenAPI \u89c4\u8303\u7684\u6587\u6863\uff0c\u6240\u4ee5 [WeCom-OpenAPI](https://github.com/juzibot/wecom-openapi) \u9879\u76ee\u5e94\u8fd0\u800c\u751f\u3002\\n\\n[WeCom-OpenAPI](https://github.com/juzibot/wecom-openapi) \u662f\u5229\u7528  NestJS \u7684 Swagger \u96c6\u6210\u80fd\u529b\u6765\u5b9e\u73b0\u7684\uff0c[@nestjs/swagger](https://www.npmjs.com/package/@nestjs/swagger) \u63d0\u4f9b\u4e86\u4e00\u4e9b\u91cc\u7684\u88c5\u9970\u5668\uff08Decorators\uff09\u6765\u58f0\u660e Swagger \u5c5e\u6027\uff0c\u65b9\u4fbf\u7ba1\u7406 API \u4e4b\u95f4\u7684\u5173\u8054\u5173\u7cfb\u3002\\n\\n## \u4f7f\u7528\u65b9\u5f0f\\n\\n\u628a\u4ee3\u7801\u514b\u9686\u4e0b\u6765\uff0c\u5b89\u88c5\u4f9d\u8d56\u540e\u542f\u52a8\u9879\u76ee\u3002\u542f\u52a8\u540e\u4f1a\u5728\u6839\u76ee\u5f55\u751f\u6210 swagger spec \u6587\u4ef6 openapi.yaml\uff0c\u540c\u65f6\u53ef\u4ee5\u7528\u6d4f\u89c8\u5668\u6253\u5f00 http://localhost:3000/openapi \u67e5\u770b Swagger UI\\n\\n```bash\\n$ git clone git@github.com:juzibot/wecom-openapi.git\\n\\n$ cd wecom-opwenapi && npm install\\n\\n$ npm run start\\n```\\n\\n[WeCom-OpenAPI](https://github.com/juzibot/wecom-openapi) \u63d0\u4f9b\u4e86\u5bf9\u4f01\u4e1a\u5fae\u4fe1 API \u7684\u4ee3\u7406\u8f6c\u53d1\uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u5728 Swagger UI \u4e0a\u76f4\u63a5\u5bf9  API \u8fdb\u884c\u8c03\u8bd5\u3002\u9996\u5148\u5c06\u4f60\u7684 AccessToken \u914d\u7f6e\u597d\u3002\\n\\n<Image img={authorizeStep} />\\n\\n\u7136\u540e\u9009\u62e9\u672c\u5730\u4ee3\u7406\u5730\u5740\u5373\u53ef\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u51fa\u73b0\u8de8\u57df\u7684\u95ee\u9898\u3002\\n\\n<Image img={proxyStep} />\\n\\n## \u4ee3\u7801\u751f\u6210\\n\\n\u4e3b\u6d41\u7684\u4ee3\u7801\u751f\u6210\u5de5\u5177\u662f [swagger-codegen](https://github.com/swagger-api/swagger-codegen)\uff0c\u4f46\u662f\u5b83\u751f\u6210\u7684 golang \u4ee3\u7801\u4e0d\u592a\u53cb\u597d\uff0c\u6240\u4ee5\u8fd9\u91cc\u63a8\u8350\u4f7f\u7528 [go-swagger](https://github.com/go-swagger/go-swagger) \u9879\u76ee\uff0c\u4f46\u662f\u76ee\u524d\u53ea\u652f\u6301 swagger 2.0 \u7248\u672c\uff0c\u6240\u4ee5\u9700\u8981\u5c06\u4e0a\u9762\u5f97\u5230\u7684  openapi.yaml \u6587\u4ef6\u8f6c\u6362\u6210\u4e00\u4e0b\u7248\u672c\u3002\u8fd9\u91cc\u4f7f\u7528 [api-spec-converter](https://www.npmjs.com/package/api-spec-converter) \u6765\u505a\u7248\u672c\u8f6c\u6362\u3002\\n\\n```bash\\n$ npm install -g api-spec-converter\\n\\n# \u8f6c\u6362\u6587\u6863\u7248\u672c\\n$ api-spec-converter --from=openapi_3 --to=swagger_2 \\\\\\n  --syntax=yaml \\\\\\n  --order=alpha \\\\\\n  ./openapi.yaml > swagger.yaml\\n \\n# \u5b89\u88c5 go-swaager \\n$ brew install go-swagger\\n \\n$ mkdir wecom-api\\n\\n# \u751f\u6210 golang \u4ee3\u7801\uff0c\u8981\u6c42\u76ee\u6807\u76ee\u5f55\u5fc5\u987b\u5728 GO_PATH \u4e2d\\n$ cd wecom-api && go mod init wecom-api\\n\\n# \u751f\u6210 golang \u4ee3\u7801\\n$ swagger generate client -f swagger.yaml -t wecom-api\\n```\\n\\n\u81f3\u6b64\uff0c\u5728 wecom-api \u76ee\u5f55\u4e2d\u4f1a\u5f97\u5230\u751f\u6210\u7684\u4ee3\u7801\u6587\u4ef6\\n\\n```\\n./wecom-api/\\n\u251c\u2500\u2500 client\\n\u2514\u2500\u2500 models\\n```\\n- client \u76ee\u5f55\u4e2d\u5b58\u653e Client \u5bf9\u8c61\u548c Parameter\u3001Response \u5305\u88c5\u5bf9\u8c61\\n- models \u76ee\u5f55\u5b58\u653e Dto\u3001Response \u7684\u5b9e\u4f53\u5b9a\u4e49\\n\\n## Example\\n\\n```go\\npackage main\\n\\nimport (\\n  \\"log\\"\\n  \\"wecom-api/client\\"\\n  \\"wecom-api/client/department\\"\\n\\n  \\"github.com/go-openapi/runtime\\"\\n  \\"github.com/go-openapi/strfmt\\"\\n)\\n\\n// \u5b9a\u4e49\u9274\u6743\u5bf9\u8c61\\ntype auth struct{}\\n\\nvar token = \\"token\\"\\n\\n// \u5b9e\u73b0 ClientAuthInfoWriter \u63a5\u53e3\\nfunc (a *auth) AuthenticateRequest(req runtime.ClientRequest, reg strfmt.Registry) error {\\n  // \u5c06 token \u653e\u5728\u6b63\u786e\u7684\u4f4d\u7f6e\\n  return req.SetQueryParam(\\"access_token\\", token)\\n}\\n\\nfunc main() {\\n  departmentID := float64(1)\\n  params := department.NewListDepartmentParams()\\n  params.SetID(&departmentID)\\n\\n  resp, err := client.Default.Department.ListDepartment(params, &auth{})\\n  if err != nil {\\n    log.Fatalf(\\"err: %v\\", err)\\n  }\\n\\n  log.Printf(\\"%v, %s\\", resp.Payload.Errcode, resp.Payload.Errmsg)\\n\\n  for _, v := range resp.Payload.Department {\\n    log.Printf(\\"%v\\", v)\\n  }\\n}\\n```"},{"id":"first-blog","metadata":{"permalink":"/zh/first-blog","editUrl":"https://github.com/juzibot/tech-blog/blog/2022-02-11-first-blog.mdx","source":"@site/i18n/zh/docusaurus-plugin-content-blog/2022-02-11-first-blog.mdx","title":"\u53e5\u5b50\u4e92\u52a8\u6280\u672f\u535a\u5ba2\u6b63\u5f0f\u4e0a\u7ebf\uff01","description":"\u6211\u4eec\u662f \u53e5\u5b50\u4e92\u52a8\u6280\u672f\u56e2\u961f\uff0c\u6211\u4eec\u4f7f\u7528\u6700\u524d\u6cbf\u7684\u6280\u672f\u6253\u9020\u57fa\u4e8e\u5373\u65f6\u804a\u5929\u8f6f\u4ef6\u7684\u4e0b\u4e00\u4ee3\u8425\u9500\u4e91\u3002\u6211\u4eec\u81f4\u529b\u4e8e\u901a\u8fc7\u4ea7\u54c1\u52a9\u529b\u4f01\u4e1a\u83b7\u5f97\u4e1a\u52a1\u4e0a\u7684\u589e\u957f\u8dc3\u8fc1\u3002","date":"2022-02-11T00:00:00.000Z","formattedDate":"2022\u5e742\u670811\u65e5","tags":[{"label":"event","permalink":"/zh/tags/event"}],"readingTime":1.195,"truncated":true,"authors":[{"name":"\u9ad8\u539f","title":"\u53e5\u5b50\u4e92\u52a8 CTO","url":"https://github.com/windmemory","imageURL":"https://github.com/windmemory.png","key":"windmemory"}],"frontMatter":{"slug":"first-blog","title":"\u53e5\u5b50\u4e92\u52a8\u6280\u672f\u535a\u5ba2\u6b63\u5f0f\u4e0a\u7ebf\uff01","authors":"windmemory","tags":["event"]},"prevItem":{"title":"\u4f01\u4e1a\u5fae\u4fe1 x Swagger","permalink":"/zh/wecom-openapi"}},"content":"import Image from \'@theme/IdealImage\';\\nimport thumbnail from \'/img/2022-02-11-first-blog/hr_qrcode.png\';\\nimport banner from \'/img/juzi-tech-team-banner.jpg\';\\n\\n\u6211\u4eec\u662f ***\u53e5\u5b50\u4e92\u52a8\u6280\u672f\u56e2\u961f***\uff0c\u6211\u4eec\u4f7f\u7528\u6700\u524d\u6cbf\u7684\u6280\u672f\u6253\u9020***\u57fa\u4e8e\u5373\u65f6\u804a\u5929\u8f6f\u4ef6\u7684\u4e0b\u4e00\u4ee3\u8425\u9500\u4e91***\u3002\u6211\u4eec\u81f4\u529b\u4e8e\u901a\u8fc7\u4ea7\u54c1\u52a9\u529b\u4f01\u4e1a\u83b7\u5f97\u4e1a\u52a1\u4e0a\u7684\u589e\u957f\u8dc3\u8fc1\u3002\\n\\n\u6211\u4eec\u4f1a\u5728\u8fd9\u91cc\u5206\u4eab\u6211\u4eec\u6280\u672f\u65c5\u7a0b\u4e0a\u6536\u83b7\u7684\u89c1\u89e3\u3002\u8fd9\u4e9b\u89c1\u89e3\u4e0d\u4ec5\u4ec5\u5173\u4e8e\u67d0\u4e9b\u5177\u4f53\u7684\u6280\u672f\uff0c\u6846\u67b6\u6216\u51fd\u6570\u5e93\uff0c\u4e5f\u4f1a\u6709\u975e\u6280\u672f\u7684\u611f\u609f\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n<Image img={banner} />\\n\\n\u6211\u4eec\u76f8\u4fe1\uff0c\u6280\u672f\u7684\u4ef7\u503c\u4f1a\u5728**\u89e3\u51b3\u771f\u5b9e\u95ee\u9898**\u7684\u65f6\u5019\u5927\u653e\u5f02\u5f69\u3002\u6240\u4ee5\u6211\u4eec\u70ed\u8877\u4e8e**\u8df3\u51fa\u601d\u7ef4\u5b9a\u52bf**\uff0c\u901a\u8fc7 hacky \u7684\u65b9\u5f0f\u6765\u89e3\u51b3\u4e00\u4e9b\u4e0d\u5e38\u89c1\uff0c\u975e\u5e38\u89c4\uff0c\u4f46\u662f\u53c8\u771f\u7684\u5bf9\u7528\u6237\u6709\u4ef7\u503c\u7684\u95ee\u9898\u3002\\n\\n---\\n\\n# \u62db\u8d24\u7eb3\u58eb\\n\u626b\u63cf\u4e0b\u9762\u7684\u4e8c\u7ef4\u7801\uff0c\u4e00\u8d77\u804a\u804a\u5728\u4e00\u5bb6\u6280\u672f\u9a71\u52a8\u7684\u516c\u53f8\u521b\u9020\u771f\u6b63\u4ef7\u503c\u7684\u673a\u4f1a\u5427\uff01\\n\\n<Image img={thumbnail} style={{ maxWidth: \'310px\' }} />"}]}')}}]);