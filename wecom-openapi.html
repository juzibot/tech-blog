<!doctype html>
<html lang="en-US" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.16">
<link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Juzi Bot RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Juzi Bot Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LLGNC8Y7ML"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-LLGNC8Y7ML",{})</script><title data-rh="true">WeCom x Swagger | Juzi Bot</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://tech-blog.juzibot.com/img/logo.svg"><meta data-rh="true" name="twitter:image" content="https://tech-blog.juzibot.com/img/logo.svg"><meta data-rh="true" property="og:url" content="https://tech-blog.juzibot.com/wecom-openapi"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="WeCom x Swagger | Juzi Bot"><meta data-rh="true" name="description" content="During the process integration with WeCom, we found that there are too many WeCom APIs needs to be integrated, and they all require different parameters. To reduce repeated work and human mistakes, we decide to use some tools generate WeCom API client code automatically."><meta data-rh="true" property="og:description" content="During the process integration with WeCom, we found that there are too many WeCom APIs needs to be integrated, and they all require different parameters. To reduce repeated work and human mistakes, we decide to use some tools generate WeCom API client code automatically."><meta data-rh="true" name="keywords" content="swagger,openapi,wecom,wxwork,workweixin,workwx,qychat,qywork,openapi3,codegen,wework,wecaht"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-02-18T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/gongzili456"><meta data-rh="true" property="article:tag" content="swagger,openapi,wecom,codegen"><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://tech-blog.juzibot.com/wecom-openapi"><link data-rh="true" rel="alternate" href="https://tech-blog.juzibot.com/wecom-openapi" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://tech-blog.juzibot.com/zh/wecom-openapi" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://tech-blog.juzibot.com/wecom-openapi" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3d703903.css">
<link rel="preload" href="/assets/js/runtime~main.c63d16f6.js" as="script">
<link rel="preload" href="/assets/js/main.481fd4a6.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_aKYr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Juzi Bot Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="Juzi Bot Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Juzi Bot</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/juzibot/tech-blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/wecom-openapi" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh/wecom-openapi" target="_self" rel="noopener noreferrer" class="dropdown__link">ä¸­æ–‡</a></li></ul></div><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/wecom-openapi">WeCom x Swagger</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/first-blog">Juzi Bot Tech Blog is Live!</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">WeCom x Swagger</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-02-18T00:00:00.000Z" itemprop="datePublished">February 18, 2022</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><a href="https://github.com/gongzili456" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/6082335" alt="Guili Liu"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/gongzili456" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Guili Liu</span></a></div><small class="avatar__subtitle" itemprop="description">Senior Engineer of Juzi Bot</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>During the process integration with WeCom, we found that there are too many WeCom APIs needs to be integrated, and they all require different parameters. To reduce repeated work and human mistakes, we decide to use some tools generate WeCom API client code automatically.</p><p>Then we found the <code>Swagger</code>, after some trial and error, we got such a convenient tool...</p><p>Github: <a href="https://github.com/juzibot/wecom-openapi" target="_blank" rel="noopener noreferrer">github.com/juzibot/wecom-openapi</a></p><p>Demo: <a href="https://wecom-openapi.juzibot.com" target="_blank" rel="noopener noreferrer">wecom-openapi.juzibot.com</a></p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="openapi-standard">OpenAPI Standard<a class="hash-link" href="#openapi-standard" title="Direct link to heading">â€‹</a></h2><p>Open API Standard (OAS) defines a standard, language irrelevant RESTful API standard. It enables developers and machines check and understand features of a specific service without accessing the source code, document or network traffic check. It is easy to read for not only human, but also machines. With a correctly defined OAS, developers could use least amount of work integrating services.</p><p>Besides, document generation tools could take advantage of OAS to generate API documents, code generation tools could automatically generate client, server code, and even test code. Refer to <a href="https://swagger.io/specification/" target="_blank" rel="noopener noreferrer">OpenAPI Specification</a>.</p><div style="background-size:cover;background-repeat:no-repeat;position:relative;background-image:url(&quot;data:image/jpeg;base64,/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAFAAoDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAQH/8QAHhAAAQUAAgMAAAAAAAAAAAAAAwABAhESEyEiUaH/xAAVAQEBAAAAAAAAAAAAAAAAAAADBP/EABgRAAIDAAAAAAAAAAAAAAAAAAACAREh/9oADAMBAAIRAxEAPwDbSgKIhSwM0Rcb+DR71d61fylYAc+EeiylLLW/vpEUjTY64f/Z&quot;)"><svg style="width:100%;height:auto;max-width:100%;margin-bottom:-4px" width="640" height="285"></svg><noscript><img style="width:100%;height:auto;max-width:100%;margin-bottom:-4px;position:absolute;top:0;left:0" src="/assets/ideal-img/swagger_banner.15c9af0.640.jpeg" srcset="/assets/ideal-img/swagger_banner.15c9af0.640.jpeg 640w,/assets/ideal-img/swagger_banner.d480f49.770.jpeg 770w,/assets/ideal-img/swagger_banner.2a80460.900.jpeg 900w,/assets/ideal-img/swagger_banner.85f7c36.1030.jpeg 1030w" width="640" height="285"></noscript></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="wecom-openapi">WeCom-OpenAPI<a class="hash-link" href="#wecom-openapi" title="Direct link to heading">â€‹</a></h2><p>WeCom does not provide documents that aligned with OAS, so we decide to create <a href="https://github.com/juzibot/wecom-openapi" target="_blank" rel="noopener noreferrer">WeCom-OpenAPI</a>.</p><p><a href="https://github.com/juzibot/wecom-openapi" target="_blank" rel="noopener noreferrer">WeCom-OpenAPI</a> is a project take advantage of the integration of <code>NestJS</code> and <code>Swagger</code>, <a href="https://www.npmjs.com/package/@nestjs/swagger" target="_blank" rel="noopener noreferrer">@nestjs/swagger</a> provides some decorators to declare Swagger attributes, make it very convenient to manage the relations between APIs.</p><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="how-to-use">How to use<a class="hash-link" href="#how-to-use" title="Direct link to heading">â€‹</a></h2><p>First of all, clone the project to your local environment, install dependencies and start the project. Then the project will automatically generate swagger spec file openapi.yaml inside the root folder. Meanwhile, you can open your browser visit http://localhost:3000/openapi to check Swagger UI.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone git@github.com:juzibot/wecom-openapi.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> wecom-opwenapi </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> run start</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><a href="https://github.com/juzibot/wecom-openapi" target="_blank" rel="noopener noreferrer">WeCom-OpenAPI</a> provides WeCom API proxy, so when you are able to debug WeCom API on Swagger UI. Just input your AccessToken as show below.</p><div style="background-size:cover;background-repeat:no-repeat;position:relative;background-image:url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAGCAYAAAD68A/GAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAxUlEQVQImUXMS0oDQRhF4dpKpYqIaDekux5/PQg4koTQ6kB0GlcnLsA9KI5Mj12DCBIU5EgawcE3OVyuMtag9Qw901hrJ3NraYzmyBjMX1M5ZZIkaq3/SuGsZFYlsayFUitq4XsWrsfHSJADIZaCF2EZHDn6qavWC/OThuubW56eXxh3O97GVx4f7ikh0PtIFEF1IXF82rDd3rH//uHz4x2+9ozjiJeECxE5DFvvaLuOXCub4YLVMLC5vOJ8vcbFiIthevwFeAxxhna8tG4AAAAASUVORK5CYII=&quot;)"><svg style="width:100%;height:auto;max-width:100%;margin-bottom:-4px" width="640" height="390"></svg><noscript><img style="width:100%;height:auto;max-width:100%;margin-bottom:-4px;position:absolute;top:0;left:0" src="/assets/ideal-img/authorize_step.433601d.640.png" srcset="/assets/ideal-img/authorize_step.433601d.640.png 640w,/assets/ideal-img/authorize_step.03ae9ff.770.png 770w,/assets/ideal-img/authorize_step.8f692d2.900.png 900w,/assets/ideal-img/authorize_step.999983f.1030.png 1030w" width="640" height="390"></noscript></div><p>Then select the local proxy endpoint to avoid cross origin issue.</p><div style="background-size:cover;background-repeat:no-repeat;position:relative;background-image:url(&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAFCAYAAAB8ZH1oAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAmUlEQVQImWWMPQuCUABF/dG9ksZw7Hc0BQ0NBVEOLRFme+TmN0aI5jN9ekKtqQv3LudwNTESjCeC2XyKYRjouo4Q4q8a3/h+gutHBFGCF8REcUJeez+MJqWk7ysjT58UWQqq5F2WFEUxMCmHx6qqWZs2y53Fam+z2Jxxw0f/1DQNbduiddOJx6vDwbpjXhy2pxthkvaiUqqXP/ycrr5S9rLbAAAAAElFTkSuQmCC&quot;)"><svg style="width:100%;height:auto;max-width:100%;margin-bottom:-4px" width="640" height="340"></svg><noscript><img style="width:100%;height:auto;max-width:100%;margin-bottom:-4px;position:absolute;top:0;left:0" src="/assets/ideal-img/proxy_step.f07be93.640.png" srcset="/assets/ideal-img/proxy_step.f07be93.640.png 640w,/assets/ideal-img/proxy_step.37f26e1.770.png 770w,/assets/ideal-img/proxy_step.78699f7.900.png 900w,/assets/ideal-img/proxy_step.056fd06.1030.png 1030w" width="640" height="340"></noscript></div><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="code-generation">Code generation<a class="hash-link" href="#code-generation" title="Direct link to heading">â€‹</a></h2><p>The common code generation tool is <a href="https://github.com/swagger-api/swagger-codegen" target="_blank" rel="noopener noreferrer">swagger-codegen</a>, but this project does not generate a developer friendly golang code, so we recommend to use <a href="https://github.com/go-swagger/go-swagger" target="_blank" rel="noopener noreferrer">go-swagger</a> if you want to generate golang code. But this project only support Swagger 2.0, so we need to conver the version of the openapi.yaml file. Here we use <a href="https://www.npmjs.com/package/api-spec-converter" target="_blank" rel="noopener noreferrer">api-spec-converter</a> to do the version conversion.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx bash"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">npm</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> -g api-spec-converter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># convert doc version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ api-spec-converter --from</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">openapi_3 --to</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">swagger_2 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --syntax</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">yaml </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --order</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">alpha </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ./openapi.yaml </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> swagger.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># install go-swaager </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ brew </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> go-swagger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> wecom-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># generate golang code, the target folder must be in GO_PATH</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token builtin class-name">cd</span><span class="token plain"> wecom-api </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> go mod init wecom-api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># generate golang code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ swagger generate client -f swagger.yaml -t wecom-api</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Util here, we can see the generated code file inside <code>wecom-api</code> folder.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">./wecom-api/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â”œâ”€â”€ client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">â””â”€â”€ models</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>client folder: Client, Parameter and Response Object</li><li>models folder: DTO, Response Entities definition</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_R0VQ" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">â€‹</a></h2><div class="codeBlockContainer_I0IT language-go theme-code-block"><div class="codeBlockContent_wNvx go"><pre tabindex="0" class="prism-code language-go codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">package</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;log&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;wecom-api/client&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;wecom-api/client/department&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;github.com/go-openapi/runtime&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string" style="color:#e3116c">&quot;github.com/go-openapi/strfmt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// define auth object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> auth </span><span class="token keyword" style="color:#00009f">struct</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">var</span><span class="token plain"> token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;token&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// implement ClientAuthInfoWriter api</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">auth</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AuthenticateRequest</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">req runtime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ClientRequest</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reg strfmt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Registry</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token builtin">error</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// put the token at the right place</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> req</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetQueryParam</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;access_token&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> token</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">func</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  departmentID </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">float64</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  params </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> department</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">NewListDepartmentParams</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  params</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">SetID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">departmentID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Default</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Department</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ListDepartment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">auth</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Fatalf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;err: %v&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%v, %s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Payload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Errcode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Payload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Errmsg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">range</span><span class="token plain"> resp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Payload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Department </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%v&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/swagger">swagger</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/openapi">openapi</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/wecom">wecom</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/tags/codegen">codegen</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/juzibot/tech-blog/blog/2022-02-18-wecom-openapi.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/first-blog"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Juzi Bot Tech Blog is Live!</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#openapi-standard" class="table-of-contents__link toc-highlight">OpenAPI Standard</a></li><li><a href="#wecom-openapi" class="table-of-contents__link toc-highlight">WeCom-OpenAPI</a></li><li><a href="#how-to-use" class="table-of-contents__link toc-highlight">How to use</a></li><li><a href="#code-generation" class="table-of-contents__link toc-highlight">Code generation</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://juzibot.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Learn About Juzi Bot</a></li><li class="footer__item"><a href="https://github.com/juzibot" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Juzi Bot Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c63d16f6.js"></script>
<script src="/assets/js/main.481fd4a6.js"></script>
</body>
</html>